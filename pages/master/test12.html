<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Kiosk Work Status Table</title>
    <link
      rel="stylesheet"
      href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css"
    />
    <link
      rel="stylesheet"
      href="https://cdn.datatables.net/1.10.21/css/jquery.dataTables.min.css"
    />
    <style>
      .circle {
        width: 16px;
        height: 16px;
        border-radius: 50%;
        display: inline-block;
        margin-right: 8px;
      }
      .red-circle {
        background-color: red;
      }
      .yellow-circle {
        background-color: yellow;
      }
      .blue-circle {
        background-color: blue;
      }

      .badge-warning {
        border: 1px solid rgba(255, 142, 66, 1);
        border-radius: 5px;
        background-color: #fff0e5;
        color: #ff8e42;
        font: 400 16px "Arial", sans-serif;
        margin-top: 3px;
      }
      .badge-danger {
        border-radius: 5px;
        border: 1px solid rgba(255, 66, 66, 1);
        background-color: #ffe5e5;
        color: #ff4242;
        font: 400 16px "Arial", sans-serif;
        margin-top: 3px;
      }

      .badge-primary {
        border-radius: 5px;
        border: 1px solid #377DFF;
        background-color: #ffe5e5;
        color: #377DFF;
        font: 400 16px "Arial", sans-serif;
        margin-top: 3px;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <h1 class="mt-4">Kiosk Work Status Table</h1>
      <table id="statusTable" class="display">
        <thead>
          <tr>
            <th>Status</th>
            <th>Kiosk Number</th>
            <th>Work Status</th>
            <th>Details</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>Server has an error</td>
            <td>1</td>
            <td class="badge">Under repair</td>
            <td><a href="details.html">Details</a></td>
          </tr>
          <tr>
            <td>Certificate form is out</td>
            <td>2</td>
            <td class="badge">In queue</td>
            <td><a href="details.html">Details</a></td>
          </tr>
          <tr>
            <td>Printer not detected</td>
            <td>3</td>
            <td class="badge" style="text-align: center">Normal</td>
            <td><a href="details.html">Details</a></td>
          </tr>
          <tr>
            <td>Paper almost used up</td>
            <td>4</td>
            <td class="badge">Under repair</td>
            <td><a href="details.html">Details</a></td>
          </tr>
          <tr>
            <td>Toner almost used up</td>
            <td>5</td>
            <td class="badge">In queue</td>
            <td><a href="details.html">Details</a></td>
          </tr>
          <tr>
            <td>Normal</td>
            <td>6</td>
            <td class="badge">Normal</td>
            <td><a href="details.html">Details</a></td>
          </tr>
          <!-- Add more rows as needed -->
        </tbody>
      </table>
    </div>

    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
    <script src="https://cdn.datatables.net/1.10.21/js/jquery.dataTables.min.js"></script>
    <script>
      $(document).ready(function () {
        // Initialize DataTable
        var table = $("#statusTable").DataTable();

        // Function to add status circles and work status logic
        function addStatusCirclesAndLogic() {
          $("#statusTable tbody tr").each(function () {
            var statusText = $(this).find("td").eq(0).text().toLowerCase();
            var workStatusText = $(this).find("td").eq(2).text().toLowerCase();

            var circleClass = "";
            var statusClass = "";

            if (
              statusText.includes("server has an error") ||
              statusText.includes("certificate form is out") ||
              statusText.includes("printer not detected")
            ) {
              circleClass = "red-circle";
            } else if (
              statusText.includes("paper almost used up") ||
              statusText.includes("toner almost used up")
            ) {
              circleClass = "yellow-circle";
            } else if (statusText.includes("normal")) {
              circleClass = "blue-circle";
            }

            if (workStatusText.includes("under repair")) {
              statusClass = "yellow-outline";
            } else if (workStatusText.includes("in queue")) {
              statusClass = "red-outline";
            }

            if (workStatusText.includes("under repair")) {
              statusClass = "badge badge-warning";
            } else if (workStatusText.includes("in queue")) {
              statusClass = "badge badge-danger";
            } else if (workStatusText.includes("normal")) {
              statusClass = "badge badge-primary";
            }

            if (circleClass) {
              var circle = $("<span>").addClass("circle").addClass(circleClass);
              $(this).find("td").eq(0).prepend(circle);
            }

            if (statusClass) {
              $(this).find("td").eq(2).addClass(statusClass);
            }
          });
        }

        // Call the function to add status circles and logic
        addStatusCirclesAndLogic();

        // Add logic to add new rows with details link
        $("#addRowBtn").on("click", function () {
          table.row
            .add([
              "New Status",
              "New Kiosk",
              "New Work Status",
              '<a href="details.html">Details</a>',
            ])
            .draw(false);

          // Reapply status circles and logic after adding new row
          addStatusCirclesAndLogic();
        });
      });
    </script>
  </body>
</html>
