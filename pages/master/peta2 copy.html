<!DOCTYPE html>
<html>
  <head>
    <title>Earthquake Effect Markers in Indonesia</title>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
    <style>
      #map {
        height: 600px;
      }

      .legend {
        font-family: Arial, sans-serif;
        background: white;
        padding: 10px;
        border-radius: 5px;
        box-shadow: 0 0 5px rgba(0, 0, 0, 0.2);
      }

      .legend-item {
        margin-bottom: 5px;
      }

      .legend-color {
        display: inline-block;
        width: 20px;
        height: 20px;
        border-radius: 50%;
        margin-right: 10px;
      }
    </style>
  </head>
  <body>
    <div class="legend">
      <div class="legend-item">
        <span class="legend-color" style="background-color: red;"></span> Error
      </div>
      <div class="legend-item">
        <span class="legend-color" style="background-color: yellow;"></span> Maintenance
      </div>
      <div class="legend-item">
        <span class="legend-color" style="background-color: blue;"></span> Normal
      </div>
    </div>
    <div id="map"></div>
    <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
    <script>
      // Initialize the map centered on Indonesia
      var map = L.map("map").setView([-2.5, 118.0], 5); // Central coordinates of Indonesia

      // Add the base layer from OpenStreetMap
      L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png", {
        attribution: "&copy; OpenStreetMap contributors",
      }).addTo(map);

      // Function to extract earthquake locations from the table
      function extractEarthquakeLocationsFromTable() {
        var earthquakeLocations = [];
        var tableRows = document.querySelectorAll("#earthquakeTable tbody tr");
        tableRows.forEach(function (row) {
          var cells = row.querySelectorAll("td");
          var latitude = parseFloat(cells[0].textContent);
          var longitude = parseFloat(cells[1].textContent);
          var magnitude = parseFloat(cells[2].textContent);
          var location = cells[3].textContent;
          var status = cells[4].textContent.toLowerCase();
          earthquakeLocations.push({
            lat: latitude,
            lng: longitude,
            magnitude: magnitude,
            location: location,
            status: status,
          });
        });
        return earthquakeLocations;
      }

      // Add earthquake markers to the map
      function addEarthquakeMarkers() {
        var earthquakeLocations = extractEarthquakeLocationsFromTable();
        earthquakeLocations.forEach(function (earthquake) {
          var iconUrl;
          switch (earthquake.status) {
            case "error":
              iconUrl =
                'data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="35" height="35" viewBox="0 0 20 20"><circle cx="10" cy="10" r="8" fill="red"><animate attributeName="r" from="8" to="12" dur="1s" repeatCount="indefinite" /><animate attributeName="opacity" from="1" to="0" dur="1s" repeatCount="indefinite" /></circle></svg>';
              break;
            case "maintenance":
              iconUrl =
                'data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="35" height="35" viewBox="0 0 20 20"><circle cx="10" cy="10" r="8" fill="yellow"><animate attributeName="r" from="8" to="12" dur="1s" repeatCount="indefinite" /><animate attributeName="opacity" from="1" to="0" dur="1s" repeatCount="indefinite" /></circle></svg>';
              break;
            default:
              iconUrl =
                'data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="35" height="35" viewBox="0 0 20 20"><circle cx="10" cy="10" r="8" fill="blue"><animate attributeName="r" from="8" to="12" dur="1s" repeatCount="indefinite" /><animate attributeName="opacity" from="1" to="0" dur="1s" repeatCount="indefinite" /></circle></svg>';
              break;
          }

          var earthquakeIcon = L.icon({
            iconUrl: iconUrl,
            iconSize: [20, 20],
            iconAnchor: [10, 10], // Center the icon
          });

          var earthquakeMarker = L.marker([earthquake.lat, earthquake.lng], {
            icon: earthquakeIcon,
          }).addTo(map);

          // Bind a popup to each marker
          earthquakeMarker.bindPopup(
            "Earthquake Location: " +
              earthquake.location +
              "<br>Magnitude: " +
              earthquake.magnitude +
              "<br>Status: " +
              earthquake.status
          );
        });
      }

      // Call the function to add markers when the page loads
      window.onload = addEarthquakeMarkers;
    </script>

    <!-- Table containing earthquake locations -->
    <table id="earthquakeTable" style="display: none">
      <thead>
        <tr>
          <th>Latitude</th>
          <th>Longitude</th>
          <th>Magnitude</th>
          <th>Location</th>
          <th>Status</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>-6.2088</td>
          <td>106.8456</td>
          <td>5.0</td>
          <td>Jakarta</td>
          <td>Error</td>
        </tr>
        <tr>
          <td>-7.7972</td>
          <td>110.3705</td>
          <td>4.8</td>
          <td>Yogyakarta</td>
          <td>Maintenance</td>
        </tr>
        <tr>
          <td>-8.3405</td>
          <td>115.0920</td>
          <td>5.3</td>
          <td>Bali</td>
          <td>Normal</td>
        </tr>
        <tr>
          <td>-0.8990</td>
          <td>100.3543</td>
          <td>5.6</td>
          <td>Padang</td>
          <td>Error</td>
        </tr>
        <tr>
          <td>-2.9814</td>
          <td>104.7642</td>
          <td>5.7/td>
          <td>Palembang</td>
          <td>Error</td>
        </tr>
        <tr>
          <td>-3.6557</td>
          <td>128.1900</td>
          <td>5.4</td>
          <td>Ambon</td>
          <td>Error</td>
        </tr>
        <tr>
          <td>-5.1477</td>
          <td>119.4327</td>
          <td>4.9</td>
          <td>Makassar</td>
          <td>Error</td>
        </tr>
        <tr>
          <td>3.5952</td>
          <td>98.6722</td>
          <td>5.1</td>
          <td>Medan</td>
          <td>Error</td>
        </tr>
        <tr>
          <td>1.4558</td>
          <td>124.8486</td>
          <td>5.5</td>
          <td>Manado</td>
          <td>Error</td>
        </tr>
        <tr>
          <td>-0.7893</td>
          <td>113.9213</td>
          <td>5.2</td>
          <td>Central Kalimantan</td>
          <td>Error</td>
        </tr>
        <!-- Add more rows as needed -->
      </tbody>
    </table>
  </body>
</html>
